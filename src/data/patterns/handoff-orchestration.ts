import { PatternScenario } from './types';
import { nodeStyle, edgeStyle } from './styles';

export const handoffOrchestrationPattern: PatternScenario = {
  id: 'handoff-orchestration',
  title: 'Handoff Orchestration',
  description: 'Coordinated transfer of tasks between specialized agents, ensuring smooth transitions, context preservation, and optimal routing based on agent capabilities and current workloads.',
  initialNodes: [
    {
      id: 'user-query',
      position: { x: 400, y: 50 },
      data: { label: 'üéØ User Query\n"Help me diagnose network issue, fix code bug, and deploy"' },
      style: { ...nodeStyle, background: '#10b981', minWidth: 380 },
    },
    {
      id: 'handoff-controller',
      position: { x: 375, y: 150 },
      data: { label: 'üéõÔ∏è Handoff Controller\nContext analysis & routing' },
      style: { ...nodeStyle, background: '#3b82f6', minWidth: 250 },
    },
    // Context Analysis
    {
      id: 'context-analyzer',
      position: { x: 150, y: 250 },
      data: { label: 'üîç Context Analyzer\nCurrent: Network diagnosis' },
      style: { ...nodeStyle, background: '#7c3aed', minWidth: 200 },
    },
    {
      id: 'capability-matcher',
      position: { x: 375, y: 250 },
      data: { label: 'üéØ Capability Matcher\nMatch task to expert' },
      style: { ...nodeStyle, background: '#7c3aed', minWidth: 200 },
    },
    {
      id: 'state-manager',
      position: { x: 600, y: 250 },
      data: { label: 'üíæ State Manager\nPreserve context across handoffs' },
      style: { ...nodeStyle, background: '#7c3aed', minWidth: 200 },
    },
    // Specialized Agents with Status
    {
      id: 'triage-agent',
      position: { x: 50, y: 380 },
      data: { label: 'üè• Triage Agent\nInitial assessment\nStatus: ‚úÖ Complete' },
      style: { ...nodeStyle, background: '#94a3b8', minWidth: 160 },
    },
    {
      id: 'network-specialist',
      position: { x: 220, y: 380 },
      data: { label: 'üåê Network Specialist\nDiagnose connectivity\nStatus: üîÑ Active' },
      style: { ...nodeStyle, background: '#22c55e', minWidth: 160 },
    },
    {
      id: 'code-debugger',
      position: { x: 390, y: 380 },
      data: { label: 'üêõ Code Debugger\nFix bugs\nStatus: ‚è≥ Waiting' },
      style: { ...nodeStyle, background: '#fbbf24', minWidth: 160 },
    },
    {
      id: 'deployment-expert',
      position: { x: 560, y: 380 },
      data: { label: 'üöÄ Deployment Expert\nDeploy to production\nStatus: ‚è≥ Waiting' },
      style: { ...nodeStyle, background: '#fbbf24', minWidth: 160 },
    },
    {
      id: 'qa-validator',
      position: { x: 730, y: 380 },
      data: { label: '‚úÖ QA Validator\nFinal checks\nStatus: ‚è≥ Waiting' },
      style: { ...nodeStyle, background: '#fbbf24', minWidth: 160 },
    },
    // Handoff Points with Context
    {
      id: 'handoff-1',
      position: { x: 135, y: 500 },
      data: { label: 'üîÑ Handoff #1\nTriage ‚Üí Network\nContext: "Timeout errors"' },
      style: { ...nodeStyle, background: '#ec4899', minWidth: 180 },
    },
    {
      id: 'handoff-2',
      position: { x: 305, y: 500 },
      data: { label: 'üîÑ Handoff #2\nNetwork ‚Üí Debug\nContext: "API endpoint fail"' },
      style: { ...nodeStyle, background: '#ec4899', minWidth: 180 },
    },
    {
      id: 'handoff-3',
      position: { x: 475, y: 500 },
      data: { label: 'üîÑ Handoff #3\nDebug ‚Üí Deploy\nContext: "Fix applied"' },
      style: { ...nodeStyle, background: '#ec4899', minWidth: 180 },
    },
    {
      id: 'handoff-4',
      position: { x: 645, y: 500 },
      data: { label: 'üîÑ Handoff #4\nDeploy ‚Üí QA\nContext: "Verify in prod"' },
      style: { ...nodeStyle, background: '#ec4899', minWidth: 180 },
    },
    // Decision Points
    {
      id: 'decision-engine',
      position: { x: 200, y: 620 },
      data: { label: 'ü§î Decision Engine\nDetermine next agent' },
      style: { ...nodeStyle, background: '#f59e0b', minWidth: 180 },
    },
    {
      id: 'handoff-validator',
      position: { x: 400, y: 620 },
      data: { label: '‚úîÔ∏è Handoff Validator\nVerify readiness' },
      style: { ...nodeStyle, background: '#f59e0b', minWidth: 180 },
    },
    {
      id: 'fallback-handler',
      position: { x: 600, y: 620 },
      data: { label: '‚Ü©Ô∏è Fallback Handler\nHandle failed handoffs' },
      style: { ...nodeStyle, background: '#f59e0b', minWidth: 180 },
    },
    // Context Preservation
    {
      id: 'context-package',
      position: { x: 100, y: 740 },
      data: { label: 'üì¶ Context Package\n‚Ä¢ Problem history\n‚Ä¢ Previous findings\n‚Ä¢ Partial solutions' },
      style: { ...nodeStyle, background: '#ef4444', minWidth: 180 },
    },
    {
      id: 'handoff-log',
      position: { x: 300, y: 740 },
      data: { label: 'üìù Handoff Log\n‚Ä¢ Agent sequence\n‚Ä¢ Decision reasons\n‚Ä¢ Time spent' },
      style: { ...nodeStyle, background: '#ef4444', minWidth: 180 },
    },
    {
      id: 'knowledge-transfer',
      position: { x: 500, y: 740 },
      data: { label: 'üß† Knowledge Transfer\n‚Ä¢ Key insights\n‚Ä¢ Action items\n‚Ä¢ Constraints' },
      style: { ...nodeStyle, background: '#ef4444', minWidth: 180 },
    },
    {
      id: 'completion-checker',
      position: { x: 700, y: 740 },
      data: { label: 'üéØ Completion Checker\n‚Ä¢ Goals achieved\n‚Ä¢ Tasks remaining' },
      style: { ...nodeStyle, background: '#ef4444', minWidth: 180 },
    },
    // Monitoring & Optimization
    {
      id: 'performance-monitor',
      position: { x: 200, y: 860 },
      data: { label: 'üìä Performance Monitor\nHandoff efficiency' },
      style: { ...nodeStyle, background: '#6366f1', minWidth: 180 },
    },
    {
      id: 'pattern-learner',
      position: { x: 400, y: 860 },
      data: { label: 'üéì Pattern Learner\nOptimize routing' },
      style: { ...nodeStyle, background: '#6366f1', minWidth: 180 },
    },
    {
      id: 'cost-optimizer',
      position: { x: 600, y: 860 },
      data: { label: 'üí∞ Cost Optimizer\nMinimize handoffs' },
      style: { ...nodeStyle, background: '#6366f1', minWidth: 180 },
    },
    {
      id: 'final-output',
      position: { x: 400, y: 980 },
      data: { label: '‚ú® Completed Task\nNetwork fixed, code debugged, successfully deployed' },
      style: { ...nodeStyle, background: '#10b981', minWidth: 350 },
    },
  ],
  initialEdges: [
    {
      id: 'query-controller',
      source: 'user-query',
      target: 'handoff-controller',
      style: { ...edgeStyle, stroke: '#3b82f6' },
      animated: true,
    },
    {
      id: 'controller-context',
      source: 'handoff-controller',
      target: 'context-analyzer',
      style: { ...edgeStyle, stroke: '#7c3aed' },
      label: 'Analyze',
    },
    {
      id: 'controller-matcher',
      source: 'handoff-controller',
      target: 'capability-matcher',
      style: { ...edgeStyle, stroke: '#7c3aed' },
      label: 'Match',
    },
    {
      id: 'controller-state',
      source: 'handoff-controller',
      target: 'state-manager',
      style: { ...edgeStyle, stroke: '#7c3aed' },
      label: 'Track',
    },
    // Initial triage
    {
      id: 'controller-triage',
      source: 'handoff-controller',
      target: 'triage-agent',
      style: { ...edgeStyle, stroke: '#22c55e', strokeWidth: 3 },
      animated: true,
      label: 'Start',
    },
    // Handoff flow
    {
      id: 'triage-handoff1',
      source: 'triage-agent',
      target: 'handoff-1',
      style: { ...edgeStyle, stroke: '#ec4899', strokeWidth: 3 },
      animated: true,
    },
    {
      id: 'handoff1-network',
      source: 'handoff-1',
      target: 'network-specialist',
      style: { ...edgeStyle, stroke: '#22c55e', strokeWidth: 3 },
      animated: true,
      label: 'Transfer',
    },
    {
      id: 'network-handoff2',
      source: 'network-specialist',
      target: 'handoff-2',
      style: { ...edgeStyle, stroke: '#ec4899', strokeWidth: 3 },
      animated: true,
    },
    {
      id: 'handoff2-debugger',
      source: 'handoff-2',
      target: 'code-debugger',
      style: { ...edgeStyle, stroke: '#fbbf24', strokeWidth: 3 },
      label: 'Transfer',
    },
    {
      id: 'debugger-handoff3',
      source: 'code-debugger',
      target: 'handoff-3',
      style: { ...edgeStyle, stroke: '#ec4899', strokeWidth: 3 },
    },
    {
      id: 'handoff3-deployment',
      source: 'handoff-3',
      target: 'deployment-expert',
      style: { ...edgeStyle, stroke: '#fbbf24', strokeWidth: 3 },
      label: 'Transfer',
    },
    {
      id: 'deployment-handoff4',
      source: 'deployment-expert',
      target: 'handoff-4',
      style: { ...edgeStyle, stroke: '#ec4899', strokeWidth: 3 },
    },
    {
      id: 'handoff4-qa',
      source: 'handoff-4',
      target: 'qa-validator',
      style: { ...edgeStyle, stroke: '#fbbf24', strokeWidth: 3 },
      label: 'Transfer',
    },
    // Decision flow
    {
      id: 'handoff1-decision',
      source: 'handoff-1',
      target: 'decision-engine',
      style: { ...edgeStyle, stroke: '#f59e0b' },
      label: 'Decide',
    },
    {
      id: 'handoff2-decision',
      source: 'handoff-2',
      target: 'decision-engine',
      style: { ...edgeStyle, stroke: '#f59e0b' },
    },
    {
      id: 'decision-validator',
      source: 'decision-engine',
      target: 'handoff-validator',
      style: { ...edgeStyle, stroke: '#f59e0b' },
    },
    {
      id: 'validator-fallback',
      source: 'handoff-validator',
      target: 'fallback-handler',
      style: { ...edgeStyle, stroke: '#f59e0b' },
      label: 'On fail',
    },
    {
      id: 'fallback-controller',
      source: 'fallback-handler',
      target: 'handoff-controller',
      style: { ...edgeStyle, stroke: '#3b82f6', strokeDasharray: '5 5' },
      label: 'Retry',
    },
    // Context flow
    {
      id: 'state-package',
      source: 'state-manager',
      target: 'context-package',
      style: { ...edgeStyle, stroke: '#ef4444' },
    },
    {
      id: 'handoff1-log',
      source: 'handoff-1',
      target: 'handoff-log',
      style: { ...edgeStyle, stroke: '#ef4444' },
    },
    {
      id: 'handoff2-log',
      source: 'handoff-2',
      target: 'handoff-log',
      style: { ...edgeStyle, stroke: '#ef4444' },
    },
    {
      id: 'package-transfer',
      source: 'context-package',
      target: 'knowledge-transfer',
      style: { ...edgeStyle, stroke: '#ef4444' },
    },
    {
      id: 'transfer-completion',
      source: 'knowledge-transfer',
      target: 'completion-checker',
      style: { ...edgeStyle, stroke: '#ef4444' },
    },
    // Context to agents
    {
      id: 'package-network',
      source: 'context-package',
      target: 'network-specialist',
      style: { ...edgeStyle, stroke: '#ef4444', strokeDasharray: '5 5' },
      label: 'Context',
    },
    {
      id: 'package-debugger',
      source: 'context-package',
      target: 'code-debugger',
      style: { ...edgeStyle, stroke: '#ef4444', strokeDasharray: '5 5' },
      label: 'Context',
    },
    {
      id: 'package-deployment',
      source: 'context-package',
      target: 'deployment-expert',
      style: { ...edgeStyle, stroke: '#ef4444', strokeDasharray: '5 5' },
      label: 'Context',
    },
    // Monitoring
    {
      id: 'log-monitor',
      source: 'handoff-log',
      target: 'performance-monitor',
      style: { ...edgeStyle, stroke: '#6366f1' },
    },
    {
      id: 'monitor-learner',
      source: 'performance-monitor',
      target: 'pattern-learner',
      style: { ...edgeStyle, stroke: '#6366f1' },
    },
    {
      id: 'learner-optimizer',
      source: 'pattern-learner',
      target: 'cost-optimizer',
      style: { ...edgeStyle, stroke: '#6366f1' },
    },
    {
      id: 'optimizer-controller',
      source: 'cost-optimizer',
      target: 'handoff-controller',
      style: { ...edgeStyle, stroke: '#6366f1', strokeDasharray: '5 5' },
      label: 'Optimize',
    },
    // Final output
    {
      id: 'qa-output',
      source: 'qa-validator',
      target: 'final-output',
      style: { ...edgeStyle, stroke: '#10b981', strokeWidth: 3 },
      animated: true,
    },
    {
      id: 'completion-output',
      source: 'completion-checker',
      target: 'final-output',
      style: { ...edgeStyle, stroke: '#10b981' },
    },
  ],
  steps: [
    {
      title: 'Initial Query',
      description: 'Complex multi-step task requiring different expertise',
      activeNodes: ['user-query'],
      activeEdges: ['query-controller'],
    },
    {
      title: 'Context Analysis',
      description: 'Analyze task requirements and current context',
      activeNodes: ['handoff-controller', 'context-analyzer', 'capability-matcher', 'state-manager'],
      activeEdges: ['controller-context', 'controller-matcher', 'controller-state'],
    },
    {
      title: 'Initial Triage',
      description: 'Triage agent performs initial assessment',
      activeNodes: ['triage-agent', 'handoff-controller'],
      activeEdges: ['controller-triage'],
    },
    {
      title: 'First Handoff Decision',
      description: 'Identify network issues, handoff to specialist',
      activeNodes: ['triage-agent', 'handoff-1', 'decision-engine'],
      activeEdges: ['triage-handoff1', 'handoff1-decision'],
    },
    {
      title: 'Network Specialist Active',
      description: 'Transfer control with full context to network agent',
      activeNodes: ['handoff-1', 'network-specialist', 'context-package'],
      activeEdges: ['handoff1-network', 'package-network', 'state-package'],
    },
    {
      title: 'Second Handoff Decision',
      description: 'Network finds code issue, handoff to debugger',
      activeNodes: ['network-specialist', 'handoff-2', 'decision-engine'],
      activeEdges: ['network-handoff2', 'handoff2-decision'],
    },
    {
      title: 'Code Debugger Active',
      description: 'Transfer control with accumulated context',
      activeNodes: ['handoff-2', 'code-debugger', 'context-package', 'knowledge-transfer'],
      activeEdges: ['handoff2-debugger', 'package-debugger', 'package-transfer'],
    },
    {
      title: 'Third Handoff Decision',
      description: 'Code fixed, ready for deployment',
      activeNodes: ['code-debugger', 'handoff-3'],
      activeEdges: ['debugger-handoff3'],
    },
    {
      title: 'Deployment Expert Active',
      description: 'Deploy fixed code with full history',
      activeNodes: ['handoff-3', 'deployment-expert', 'context-package'],
      activeEdges: ['handoff3-deployment', 'package-deployment'],
    },
    {
      title: 'Final Handoff to QA',
      description: 'Transfer to QA for final validation',
      activeNodes: ['deployment-expert', 'handoff-4', 'qa-validator'],
      activeEdges: ['deployment-handoff4', 'handoff4-qa'],
    },
    {
      title: 'Performance Analysis',
      description: 'Monitor handoff efficiency and learn patterns',
      activeNodes: ['handoff-log', 'performance-monitor', 'pattern-learner', 'cost-optimizer'],
      activeEdges: ['log-monitor', 'monitor-learner', 'learner-optimizer', 'optimizer-controller'],
    },
    {
      title: 'Task Completion',
      description: 'All handoffs complete, deliver final result',
      activeNodes: ['qa-validator', 'completion-checker', 'final-output'],
      activeEdges: ['qa-output', 'completion-output', 'transfer-completion'],
    },
  ],
};